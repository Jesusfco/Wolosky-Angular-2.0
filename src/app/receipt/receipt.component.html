<mat-progress-bar mode="indeterminate" *ngIf="sendingData.notifications" class="barLoader"></mat-progress-bar>
<mat-progress-bar mode="indeterminate" *ngIf="sendingData.receipts" class="barLoader"></mat-progress-bar>

<div class="relative">

    <h2 class="centerText">Recibos de Alumnos </h2>

    <div *ngIf="notifications.on" class="notifyReceipt">
        <h5>Notificaciones</h5>
        <div>
            <p>Hay #{{ notifications.debtorsMonthly }} alumnos con pagos pendientes de este mes.
                <span (click)="notifications.viewDebtors = !notifications.viewDebtors">Ver Alumnos</span>
            </p>

            <div *ngIf="notifications.viewDebtors" id="debtors">
                <p *ngFor="let deb of notifications.debtors" (click)="debtorPay(deb)" [routerLink]="['/receipt/create']"> {{ deb.name }}</p>
            </div>
            <!-- <p>Hay #{{ notifications.debtorsInscription }} alumnos con inscripciones pendientes de este mes.</p> -->
        </div>

    </div>

    <form class="form" (submit)="getReceipts()">
        <input (change)="getReceipts()" type="date" [(ngModel)]="search.from" name="from" id="search"><label><mat-icon>date_range</mat-icon></label>
        <input (change)="getReceipts()" type="date" [(ngModel)]="search.to" name="to" id="search" *ngIf="storage.getUserType() >= 6"><label *ngIf="storage.getUserType() >= 6">
            <mat-icon>date_range</mat-icon></label>

        <input [(ngModel)]="search.name" [matAutocomplete]="auto" name="name" id="search" type="search" placeholder="Buscar Usuario" (keyup)="searchInput($event)"><label><mat-icon>search</mat-icon></label>

        <mat-autocomplete #auto="matAutocomplete">
            <mat-option *ngFor="let sugest of sugests" [value]="sugest.name" (onSelectionChange)="searchReceiptId(sugest.id)">
                {{ sugest.name }}
            </mat-option>
        </mat-autocomplete>

    </form>




    <div class="responsive-table">
        <table align="center">
            <thead>
                <tr>
                    <!-- <th class="left">id</th> -->
                    <th>Alumno</th>
                    <th>Monto</th>
                    <th>Tipo</th>
                    <th>Fecha-Hora Creaci√≥n</th>
                </tr>
                <!-- <th colspan="3">Opciones</th> -->
            </thead>
            <tbody>
                <tr *ngFor="let re of receipts" [routerLink]="['/receipt/show', re.id]">
                    <td class="left">{{ re.user.name }}</td>
                    <td>$ {{ re.amount }}</td>
                    <td>{{re.typeView()}}</td>
                    <td>{{ re.created_at }}</td>



                </tr>
            </tbody>

        </table>

        <mat-paginator (page)="pageAction($event)" [length]="search.total" [pageSize]="search.items" [pageSizeOptions]="[5, 10, 25, 50, 100]">
        </mat-paginator>

    </div>

</div>

<div class="floatOptions">

    <div class="moreOptions">

        <a target="_blank" href="{{ storage.getUrl() + 'excel/receipt' +storage.getTokenUrl() }}
            &from={{ search.from }}&to={{ search.to }}&id={{ search.id }}">
            <button matTooltip="Descargar Recibos" matTooltipPosition="left" mat-fab id="cancelButton">
                <mat-icon >archive</mat-icon>
            </button>
        </a>

        <button matTooltip="Deudores del mes" matTooltipPosition="left" mat-fab>
            <mat-icon >people</mat-icon>
        </button>

        <button [routerLink]="['./create']" matTooltip="Crear Recibo" matTooltipPosition="left" mat-fab>
            <mat-icon >create</mat-icon>
        </button>
    </div>

    <button matTooltip="Opciones de Recibos" matTooltipPosition="left" mat-fab color="pri" class="floatOptionPrincipal">
                <mat-icon >settings</mat-icon>
            </button>

</div>

<router-outlet></router-outlet>